## 1.应用阶段

---

### 1. 数据加载到显卡
### 2. 设置opengl api渲染状态
cpu 宿主程序和GPU交互关键是状态机的概念，cpu无法直接调用GPU执行一个命令，而是通过状态机记录宿主程序要执行GPU的状态。
### 3. 调用Draw Call
指向一个需要被渲染的图元
是一个命令，每次调用都对传入顶点数据进行计算
---

## 2.几何阶段
```
graph TD

A[顶点数据] --> B[顶点着色器]
B --> C[曲面细分着色器]
C --> D[几何着色器]
D --> E[裁剪]
E --> 屏幕映射

```
### 1. 顶点着色器
顶点从模型空间转世界空间视空间
### 2.裁剪

 1 .顶点要从视空间到裁剪空间。具体操作：投影Matrix * 顶点坐标。

 2 .为了不处理不在视野内的场景物体，所以进行裁剪，被裁减的模型会生成新的顶点。
 顶点通过-w<=x<=w;-w<=y<=w; -w<=z<=w;判断是否在视野范围内



### 3.屏幕映射

顶点完成裁剪后，开始真正投影，投影到屏幕空间，具体操作对顶点进行齐次除法（homogeneous division）顶点坐标转为归一化设备坐标。

 

---

## 3.光栅阶段
```
graph TD
三角形设置 --> 三角形遍历
三角形遍历 --> 片段着色器
片段着色器 --> 逐片元操作
逐片元操作 --> 屏幕图像
```
### 1.三角形设置
为了计算像素是否被三角形覆盖，必须计算每条边的像素信息。需要计算三角形边界表示方式
### 2.遍历三角形
检查每个像素是否三角形覆盖，如果覆盖就会生成一个片元。片元的像素信息和法线信息位置信息都是经过顶点线性差值计算出来的。
### 3.片元着色器
灯光位置，材质信息，片元位置，相机位置，计算光照
根据差值得到的每个片段的纹理坐标，纹理采样，
### 4.逐片段操作
1. 决定可见性，深度测试，模板测试
2. 和并或者混合。